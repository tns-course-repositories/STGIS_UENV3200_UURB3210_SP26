<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-02-13">

<title>Class 4 Assignment: Categorical and Proportional Symbolization - NYC Transit Cartographic Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="c4_assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="c4_assignment_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="c4_assignment_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="c4_assignment_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="c4_assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="c4_assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="c4_assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="c4_assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="c4_assignment_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="c4_assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="c4_assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="c4_assignment_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="c4_assignment_files/styles.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#assignment-4---overview-goals" id="toc-assignment-4---overview-goals" class="nav-link active" data-scroll-target="#assignment-4---overview-goals">ğŸ¯ Assignment 4 - Overview &amp; Goals</a></li>
  <li><a href="#class-4-recorded-lecture" id="toc-class-4-recorded-lecture" class="nav-link" data-scroll-target="#class-4-recorded-lecture">ğŸ¬ Class 4 Recorded Lecture:</a></li>
  <li><a href="#class-4-readings" id="toc-class-4-readings" class="nav-link" data-scroll-target="#class-4-readings">ğŸ“š Class 4 Readings:</a></li>
  <li><a href="#data-sources-4-individual-downloads-in-total" id="toc-data-sources-4-individual-downloads-in-total" class="nav-link" data-scroll-target="#data-sources-4-individual-downloads-in-total">ğŸ“‚ Data Sources ( 4 Individual Downloads in Total)</a></li>
  <li><a href="#workflow-data-final-map" id="toc-workflow-data-final-map" class="nav-link" data-scroll-target="#workflow-data-final-map">ğŸ—º Workflow: Data â†’ Final Map</a></li>
  <li><a href="#step-1-load-data-into-qgis" id="toc-step-1-load-data-into-qgis" class="nav-link" data-scroll-target="#step-1-load-data-into-qgis">ğŸ§¾ Step 1 â€” Load Data into QGIS</a></li>
  <li><a href="#step-2-identify-pertinent-fields-prepare-aggregation-2025-monthly-average" id="toc-step-2-identify-pertinent-fields-prepare-aggregation-2025-monthly-average" class="nav-link" data-scroll-target="#step-2-identify-pertinent-fields-prepare-aggregation-2025-monthly-average">ğŸ” Step 2 â€” Identify Pertinent Fields &amp; Prepare Aggregation (2025 Monthly Average)</a></li>
  <li><a href="#step-3-apply-categorical-symbolization-service-based-styling-via-qml" id="toc-step-3-apply-categorical-symbolization-service-based-styling-via-qml" class="nav-link" data-scroll-target="#step-3-apply-categorical-symbolization-service-based-styling-via-qml">ğŸ¨ Step 3 â€” Apply Categorical Symbolization (Service-Based Styling via QML)</a></li>
  <li><a href="#step-4-apply-proportional-symbol-sizing-ridership" id="toc-step-4-apply-proportional-symbol-sizing-ridership" class="nav-link" data-scroll-target="#step-4-apply-proportional-symbol-sizing-ridership">ğŸ“ Step 4 â€” Apply Proportional Symbol Sizing (Ridership)</a></li>
  <li><a href="#step-5-add-context-confirm-visual-hierarchy" id="toc-step-5-add-context-confirm-visual-hierarchy" class="nav-link" data-scroll-target="#step-5-add-context-confirm-visual-hierarchy">ğŸ§­ Step 5 â€” Add Context &amp; Confirm Visual Hierarchy</a></li>
  <li><a href="#step-6-build-print-layout" id="toc-step-6-build-print-layout" class="nav-link" data-scroll-target="#step-6-build-print-layout">ğŸ–¨ Step 6 â€” Build Print Layout</a></li>
  <li><a href="#step-7-export-deliverables" id="toc-step-7-export-deliverables" class="nav-link" data-scroll-target="#step-7-export-deliverables">ğŸ“¤ Step 7 â€” Export Deliverables</a></li>
  <li><a href="#reflection-150250-words" id="toc-reflection-150250-words" class="nav-link" data-scroll-target="#reflection-150250-words">âœï¸ Reflection (150â€“250 Words)</a></li>
  <li><a href="#deliverables-at-canvas" id="toc-deliverables-at-canvas" class="nav-link" data-scroll-target="#deliverables-at-canvas">ğŸ“¦ Deliverables at Canvas</a></li>
  <li><a href="#map-example" id="toc-map-example" class="nav-link" data-scroll-target="#map-example">ğŸ“Œ Map Example</a></li>
  <li><a href="#grading-rubric" id="toc-grading-rubric" class="nav-link" data-scroll-target="#grading-rubric">ğŸ§® Grading Rubric</a></li>
  <li><a href="#conceptual-takeaway" id="toc-conceptual-takeaway" class="nav-link" data-scroll-target="#conceptual-takeaway">ğŸ§  Conceptual Takeaway</a></li>
  <li><a href="#video-guides" id="toc-video-guides" class="nav-link" data-scroll-target="#video-guides">Video Guides</a></li>
  <li><a href="#further-reference" id="toc-further-reference" class="nav-link" data-scroll-target="#further-reference">Further Reference</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 4 Assignment: Categorical and Proportional Symbolization - NYC Transit Cartographic Design</h1>
<p class="subtitle lead">Spring 2026 | <a href="https://courses.newschool.edu/courses/UENV3200/">UENV 3200 - CRN 11009</a> + <a href="https://courses.newschool.edu/courses/UURB3210">UURB 3210 - CRN 111008</a></p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="c4_assignment_files/img/mta1.png" class="img-fluid figure-img"></p>
<figcaption>2025 MTA Subway Map (revised from previous 1979 version)</figcaption>
</figure>
</div>
<section id="assignment-4---overview-goals" class="level3">
<h3 class="anchored" data-anchor-id="assignment-4---overview-goals">ğŸ¯ Assignment 4 - Overview &amp; Goals</h3>
<p>In this assignment, you will create a <strong>multivariate point map</strong> of NYC subway stations that combines:</p>
<ul>
<li><strong>Categorical symbolization</strong> â†’ Subway Line <em>Line ID</em><br>
</li>
<li><strong>Proportional symbolization</strong> â†’ <em>Average Weekday Ridership</em></li>
</ul>
<p>You will move from <strong>raw spatial data â†’ aggregation â†’ attribute join â†’ multivariate symbology â†’ final map layout export</strong>.</p>
<p>This assignment reinforces the conceptual distinction between:</p>
<ul>
<li><em>Type</em> (qualitative difference)</li>
<li><em>Intensity</em> (quantitative magnitude)</li>
</ul>
<section id="learning-benchmarks" class="level4">
<h4 class="anchored" data-anchor-id="learning-benchmarks">âœ… Learning Benchmarks</h4>
<p>By the end of this assignment, you should be able to:</p>
<ul>
<li>Load and inspect spatial and tabular datasets in QGIS<br>
</li>
<li>Aggregate a date subset based on <em>average</em> statistic (ridership per month, 2025)</li>
<li>Identify and apply a correct join key between a point layer and a CSV table<br>
</li>
<li>Apply categorical styling using a qualitative field (line ID)<br>
</li>
<li>Apply proportional symbol scaling using a numeric field (ridership)<br>
</li>
<li>Manage clutter/overplotting through symbol and layout design choices<br>
</li>
<li>Produce a polished layout with clear legends for <strong>both</strong> variables</li>
</ul>
</section>
</section>
<section id="class-4-recorded-lecture" class="level3">
<h3 class="anchored" data-anchor-id="class-4-recorded-lecture">ğŸ¬ Class 4 Recorded Lecture:</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://vimeo.com/866441838"><img src="c4_assignment_files/img/lecture.png" class="img-fluid figure-img"></a></p>
<figcaption>Class 4 Recorded Lecture (Titled Lecture 3)</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before proceeding with assignment steps below, review the posted lecture slides + lecture recording for an overview of this weekâ€™s concepts and themes.</p>
</div>
</div>
</section>
<section id="class-4-readings" class="level3">
<h3 class="anchored" data-anchor-id="class-4-readings">ğŸ“š Class 4 Readings:</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two previous readings will be featured on Quiz #4 upcoming at the start of Week 5.</p>
</div>
</div>
</section>
<section id="data-sources-4-individual-downloads-in-total" class="level3">
<h3 class="anchored" data-anchor-id="data-sources-4-individual-downloads-in-total">ğŸ“‚ Data Sources ( 4 Individual Downloads in Total)</h3>
<section id="subway-stations-service-point-locations-with-ridership-data" class="level4">
<h4 class="anchored" data-anchor-id="subway-stations-service-point-locations-with-ridership-data">1 ğŸš† Subway Stations (Service Point Locations with Ridership Data)</h4>
<ul>
<li><p><strong>Source:</strong> DATA.NY.GOV<br>
</p></li>
<li><p><strong>Dataset:</strong> <em>Subway Stations with ridership per month, dated to 2017</em><br>
</p></li>
<li><p><strong>Geometry:</strong> Point<br>
</p></li>
<li><p><strong>Common fields:</strong> station name, division, line(s), borough, station/complex ID<br>
</p></li>
<li><p><strong>Ridership data</strong>: date_month, ridership</p></li>
<li><p><a href="https://data.ny.gov/Transportation/MTA-Subway-Station-Monthly-Ridership-Beginning-Feb/ak4z-sape/about_data">Subway Stations (Points) â€“ with Lat/Lon + Ridership Download</a></p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Export in the Shapefile format. The following backup link can be used if the official link above stalls.</p>
</div>
</div>
<ul>
<li><a href="https://weekly-materials.s3.us-west-1.amazonaws.com/MTA+Subway+Station+Monthly+Ridership_+Beginning+February+2017_20260213.zip">Alternative Subway Stations (Points) â€“ with Lat/Lon + Ridership Download</a></li>
</ul>
</section>
<section id="subway-lines-service-line-geometries" class="level4">
<h4 class="anchored" data-anchor-id="subway-lines-service-line-geometries">2 ğŸš† Subway Lines (Service Line Geometries)</h4>
<ul>
<li><p><strong>Source:</strong> DATA.NY.GOV</p></li>
<li><p><strong>Dataset:</strong> <em>MTA Subway Service Lines</em><br>
</p></li>
<li><p><strong>Geometry:</strong> Lines</p></li>
<li><p><strong>Common fields:</strong> station name, division, line(s), borough, station/complex ID</p></li>
<li><p><a href="https://data.ny.gov/Transportation/MTA-Subway-Service-Lines/s692-irgq/about_data">Subway Service Lines (Lines Geometry) Download</a></p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Export in the Shapefile format.</p>
</div>
</div>
</section>
<section id="subway-line-qgis-style-file" class="level4">
<h4 class="anchored" data-anchor-id="subway-line-qgis-style-file">3 ğŸ¨ Subway Line QGIS Style File</h4>
<ul>
<li><strong>Source:</strong> generated QGIS Style File</li>
<li><strong>Dataset:</strong> <em>QGIS Style Layer</em><br>
</li>
<li><strong>Geometry:</strong> Lines</li>
<li><strong>File suffix:</strong> <code>.qml</code></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Download the hosted <code>.qml</code> file and place it in your assignment data directory next to the subway line features themselves.</p>
</div>
</div>
<ul>
<li><a href="https://weekly-materials.s3.us-west-1.amazonaws.com/MTA_Subway_Lines_service_field_from_lines_csv.qml">QGIS <code>.qml</code> Download</a></li>
</ul>
</section>
<section id="borough-boundaries-shoreline-clipped-water-areas-excluded" class="level4">
<h4 class="anchored" data-anchor-id="borough-boundaries-shoreline-clipped-water-areas-excluded">4 ğŸ—ºï¸ Borough Boundaries (Shoreline-Clipped / Water Areas Excluded)</h4>
<ul>
<li><p><strong>Source:</strong> NYC Open Data (NYC Department of City Planning)<br>
</p></li>
<li><p><strong>Dataset:</strong> <em>Borough Boundaries (Water Areas Excluded)</em><br>
</p></li>
<li><p><strong>Geometry:</strong> Polygons<br>
</p></li>
<li><p><strong>Common fields:</strong> boroname, boro_code, shape_area, shape_leng</p></li>
<li><p><a href="https://data.cityofnewyork.us/City-Government/Borough-Boundaries/gthc-hcne">Borough Boundaries â€” Water Areas Excluded (gthc-hcne) Download</a></p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Export in the Shapefile format.</p>
</div>
</div>
</section>
</section>
<section id="workflow-data-final-map" class="level3">
<h3 class="anchored" data-anchor-id="workflow-data-final-map">ğŸ—º Workflow: Data â†’ Final Map</h3>
</section>
<section id="step-1-load-data-into-qgis" class="level3">
<h3 class="anchored" data-anchor-id="step-1-load-data-into-qgis">ğŸ§¾ Step 1 â€” Load Data into QGIS</h3>
<p><strong>Goal:</strong> Bring ridership, line dataset and borough boundaries into the same project and inspect their structure.</p>
<section id="checklist" class="level4">
<h4 class="anchored" data-anchor-id="checklist">â˜‘ï¸ Checklist</h4>
<ul class="task-list">
<li><label><input type="checkbox">Open QGIS and create a new project<br>
</label></li>
<li><label><input type="checkbox">Add the <strong>Subway Stations Ridership</strong> vector layer<br>
</label></li>
<li><label><input type="checkbox">Add the <strong>Subway Lines</strong> vector layer<br>
</label></li>
<li><label><input type="checkbox">Add the <strong>Borough Boundaries</strong> vector layer<br>
</label></li>
<li><label><input type="checkbox">Confirm CRS (use projected NYC CRS EPSG: 2263 at the project level for final map deliverable)</label></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="c4_assignment_files/img/load.png" class="img-fluid figure-img"></p>
<figcaption>Load vector layers; CRS can remain EPSG:4326 until final cartographic design</figcaption>
</figure>
</div>
</section>
</section>
<section id="step-2-identify-pertinent-fields-prepare-aggregation-2025-monthly-average" class="level3">
<h3 class="anchored" data-anchor-id="step-2-identify-pertinent-fields-prepare-aggregation-2025-monthly-average">ğŸ” Step 2 â€” Identify Pertinent Fields &amp; Prepare Aggregation (2025 Monthly Average)</h3>
<p>In this step, you will:</p>
<ul>
<li>Filter the dataset to <strong>2025 months only</strong></li>
<li>Use <strong>Group Stats</strong> to compute the average monthly ridership per station complex</li>
<li>Keep awareness of scientific notation in outputs</li>
<li>Dissolve geometry to ensure a clean 1:1 join</li>
<li>Export a properly formatted <code>.csv</code> for joining</li>
</ul>
<hr>
<section id="a-filter-to-2025-records-only" class="level4">
<h4 class="anchored" data-anchor-id="a-filter-to-2025-records-only">ğŸ—“ï¸ 2A â€” Filter to 2025 Records Only</h4>
<p>The <code>date_month</code> field is already stored as a Date type in the format <code>M/D/YY</code>. Even though the year appears as two digits (e.g., <code>12/1/25</code>), QGIS internally recognizes the full year (2025).</p>
</section>
<section id="apply-layer-filter" class="level4">
<h4 class="anchored" data-anchor-id="apply-layer-filter">â˜‘ï¸ Apply Layer Filter</h4>
<p>Right-click the ridership layer â†’ <strong>Filterâ€¦</strong></p>
<p>Use the following expression:</p>
<pre><code>"date_month" &gt;= '2025-01-01'
AND
"date_month" &lt;= '2025-12-31'</code></pre>
<p>âœ” Confirm that only 2025 records remain (5074 features should be included via applied filter)</p>
<p>âœ” Each <code>station_co</code> should now appear <strong>12 times</strong> (one for each month)</p>
<p>âœ” Scroll through and verify that all months fall within 2025</p>
<blockquote class="blockquote">
<p>ğŸ¯ Result: A clean subset containing only the 12 months of 2025 for each station complex.</p>
</blockquote>
<hr>
</section>
<section id="b-use-group-stats-to-compute-average-monthly-ridership-2025" class="level4">
<h4 class="anchored" data-anchor-id="b-use-group-stats-to-compute-average-monthly-ridership-2025">ğŸ“Š 2B â€” Use Group Stats to Compute Average Monthly Ridership (2025)</h4>
<p>We now compute the <em>average monthly ridership per station complex</em> using the filtered 2025 layer.</p>
<p>Open:</p>
<pre><code>Plugins â†’ Group Stats</code></pre>
</section>
<section id="rows-group-by" class="level4">
<h4 class="anchored" data-anchor-id="rows-group-by">ğŸŸ¦ Rows (Group By)</h4>
<p>Drag into <strong>Rows</strong>:</p>
<pre><code>station_co</code></pre>
</section>
<section id="values-aggregation" class="level4">
<h4 class="anchored" data-anchor-id="values-aggregation">ğŸŸ¨ Values (Aggregation)</h4>
<p>Drag into <strong>Values</strong>:</p>
<pre><code>ridership</code></pre>
<p>Set statistic to (Drag into <strong>Columns</strong>):</p>
<pre><code>Average</code></pre>
<p>Which equals:</p>
<blockquote class="blockquote">
<p>ğŸ¯ Average Monthly Ridership per Station Complex (2025)</p>
</blockquote>
<p>Point to assignment directory; export via <em>Data &gt; Save all to CSV file &gt;</em> <code>ridership.csv</code></p>
<p>Next, utilize <em>Data Source Manager &gt; Delimited Text</em> to import <code>ridership.csv</code>. Do note that parameters must be correct as follows:</p>
<ul>
<li>Custom delimiter = Semicolon</li>
<li>Number of header lines to discard = 1</li>
<li>First record has field names = checked</li>
<li>Detect field types = checked</li>
<li>No geometry (attribute only table) = checked</li>
</ul>
<p>âœ” Confirm that <code>station_co</code> = Integer (32 bit)</p>
<p>âœ” Confirm that <code>field_2</code> = Decimal (double)</p>
<p>âœ”Large ridership values may display in scientific notation (e.g., <code>3.4e+06</code>) in <em>Group Stats</em>; however, the <em>Decimal</em> field type should force those values to decimal format without scientific notation.</p>
<hr>
</section>
<section id="c-export-aggregated-table" class="level4">
<h4 class="anchored" data-anchor-id="c-export-aggregated-table">ğŸ’¾ 2C â€” Export Aggregated Table</h4>
<p>Click:</p>
<pre><code>Save Asâ€¦</code></pre>
<p>Navigate to directory; export to:</p>
<pre><code>avg_monthly_ridership_2025.csv</code></pre>
<p>âœ” Confirm there is <strong>one row per station_co</strong><br>
âœ” Confirm values are not displayed in scientific notation</p>
<hr>
</section>
<section id="d-dissolve-geometry-for-a-11-join" class="level4">
<h4 class="anchored" data-anchor-id="d-dissolve-geometry-for-a-11-join">ğŸ§© 2D â€” Dissolve Geometry for a 1:1 Join</h4>
<p>The original stations ridership layer still contains 12 features per station complex.<br>
To ensure a proper relational join, dissolve the geometry so that there is a simple one station point per actual station.</p>
<p>Open:</p>
<pre><code>Processing Toolbox â†’ Vector Geometry â†’ Dissolve</code></pre>
</section>
<section id="configure" class="level4">
<h4 class="anchored" data-anchor-id="configure">Configure:</h4>
<ul>
<li>Input layer: filtered 2025 ridership layer<br>
</li>
<li>Dissolve field:</li>
</ul>
<pre><code>station_co</code></pre>
<ul>
<li>Uncheck â€œKeep dissolved fieldsâ€ unless needed</li>
</ul>
<p>Run the tool.</p>
<p>âœ” Confirm resulting layer now has <strong>one feature per <code>station_co</code></strong><br>
âœ” Geometry should remain intact<br>
âœ” Geometry should overlay previous layer version with 426 total overlap points</p>
<hr>
</section>
<section id="e-join-aggregated-csv-to-dissolved-geometry" class="level4">
<h4 class="anchored" data-anchor-id="e-join-aggregated-csv-to-dissolved-geometry">ğŸ”— 2E â€” Join Aggregated CSV to Dissolved Geometry</h4>
<p>Right-click the <em>dissolved layer â†’ Properties â†’ Joins</em></p>
<p>Configure:</p>
<ul>
<li>Join layer: <code>avg_monthly_ridership_2025</code></li>
<li>Join field: <code>station_co</code></li>
<li>Target field: <code>station_co</code></li>
</ul>
<p>Click OK.</p>
<p>âœ” Confirm join is <strong>one-to-one</strong><br>
âœ” Confirm no duplicated records<br>
âœ” Confirm no unexpected NULL values<br>
âœ” Confirm <code>avg_monthly_ridership_2025</code> tracks with <code>station_co</code> across all 426 records</p>
</section>
<section id="outcome-of-step-2" class="level4">
<h4 class="anchored" data-anchor-id="outcome-of-step-2">ğŸ¯ Outcome of Step 2</h4>
<p>You now have:</p>
<ul>
<li>One geometry per station complex<br>
</li>
<li>One numeric attribute representing <strong>Average Monthly Ridership (2025)</strong><br>
</li>
<li>Clean formatting without scientific notation<br>
</li>
<li>A properly structured dataset ready for proportional symbolization</li>
</ul>
<p>This completes the data preparation phase and prepares the layer for multivariate cartographic styling.</p>
</section>
<section id="export-the-final-layer" class="level4">
<h4 class="anchored" data-anchor-id="export-the-final-layer">â˜‘ï¸ Export the Final Layer</h4>
<p>Right-click the dissolved + joined layer â†’ <em>Export â†’ Save Features Asâ€¦</em></p>
<p>Configure:</p>
<ul>
<li>Format: <strong>Shapefile</strong></li>
<li>File name:</li>
</ul>
<pre><code>subway_stations_avg_monthly_2025.shp</code></pre>
<ul>
<li>CRS: Keep project CRS</li>
<li>Check: <strong>Add saved file to map</strong></li>
</ul>
<p>Click OK.</p>
</section>
</section>
<section id="step-3-apply-categorical-symbolization-service-based-styling-via-qml" class="level3">
<h3 class="anchored" data-anchor-id="step-3-apply-categorical-symbolization-service-based-styling-via-qml">ğŸ¨ Step 3 â€” Apply Categorical Symbolization (Service-Based Styling via QML)</h3>
<p><strong>Goal:</strong> Apply official MTA route colors using the pre-built QGIS style file that categorizes by the <code>service</code> attribute.</p>
<p>Rather than manually building categorized symbology, you will load the prepared <code>.qml</code> style layer.</p>
<hr>
<section id="a-load-the-qml-style-file" class="level4">
<h4 class="anchored" data-anchor-id="a-load-the-qml-style-file">ğŸ“‚ 3A â€” Load the QML Style File</h4>
<p>Right-click the subway lines layer â†’ <em>Properties â†’ Symbology</em></p>
<p>In the lower-left corner, click:</p>
<pre><code>Style â†’ Load Styleâ€¦</code></pre>
<p>Select the provided file:</p>
<pre><code>MTA_Subway_Lines_service_field_from_lines_csv.qml</code></pre>
<p>Click <strong>Load</strong>.</p>
<hr>
</section>
<section id="checklist-1" class="level4">
<h4 class="anchored" data-anchor-id="checklist-1">â˜‘ï¸ Checklist</h4>
<ul class="task-list">
<li><label><input type="checkbox">Confirm the renderer type is <strong>Categorized</strong></label></li>
<li><label><input type="checkbox">Confirm the field used is <code>service</code></label></li>
<li><label><input type="checkbox">Confirm all service values are symbolized (no default black lines)</label></li>
<li><label><input type="checkbox">Confirm official route colors appear (e.g., A/C/E blue, 1/2/3 red, N/Q/R/W yellow, etc.)</label></li>
<li><label><input type="checkbox">Confirm no unexpected scientific or formatting issues in legend labels</label></li>
</ul>
</section>
<section id="result-of-step-3" class="level4">
<h4 class="anchored" data-anchor-id="result-of-step-3">ğŸ¯ Result of Step 3</h4>
<p>You now have:</p>
<ul>
<li>Official MTA service colors applied</li>
<li>Styling driven directly by the <code>service</code> attribute</li>
<li>Clean, standardized symbology without manual classification</li>
<li>A reproducible styling workflow for cartographic consistency</li>
</ul>
<p>This completes the categorical symbolization phase and prepares the layer for proportional symbol scaling.</p>
</section>
</section>
<section id="step-4-apply-proportional-symbol-sizing-ridership" class="level3">
<h3 class="anchored" data-anchor-id="step-4-apply-proportional-symbol-sizing-ridership">ğŸ“ Step 4 â€” Apply Proportional Symbol Sizing (Ridership)</h3>
<p><strong>Goal:</strong> Scale point size by average weekday ridership.</p>
<section id="checklist-2" class="level4">
<h4 class="anchored" data-anchor-id="checklist-2">â˜‘ï¸ Checklist</h4>
<ul class="task-list">
<li><label><input type="checkbox">Confirm ridership field is numeric (if not, create integer type field)<br>
</label></li>
<li><label><input type="checkbox">Utilize the <em>Data-Defined Size via Assistant</em> (located right of Size Attribute)</label></li>
<li><label><input type="checkbox">Set size range (example: 2 mm â€“ 12 mm); Utilize scaling methods</label></li>
<li><label><input type="checkbox">Test visibility at multiple zoom levels; create map layout to correspond with map canvas</label></li>
<li><label><input type="checkbox">Adjust transparency or stroke to reduce clutter and create maximum legibility</label></li>
</ul>
</section>
<section id="benchmark" class="level4">
<h4 class="anchored" data-anchor-id="benchmark">âœ… Benchmark</h4>
<ul>
<li>Manhattan should show density while maintaining map legibility</li>
<li>Outer borough stations remain visible<br>
</li>
<li>Category color remains legible</li>
</ul>
</section>
</section>
<section id="step-5-add-context-confirm-visual-hierarchy" class="level3">
<h3 class="anchored" data-anchor-id="step-5-add-context-confirm-visual-hierarchy">ğŸ§­ Step 5 â€” Add Context &amp; Confirm Visual Hierarchy</h3>
<p><strong>Goal:</strong> Ensure subway points remain the dominant visual layer.</p>
<section id="checklist-3" class="level4">
<h4 class="anchored" data-anchor-id="checklist-3">â˜‘ï¸ Checklist</h4>
<ul class="task-list">
<li><label><input type="checkbox">Add light borough boundary context layer basemap</label></li>
<li><label><input type="checkbox">Confirm basemap does not overpower symbols (transparent fill is a recommended option here)<br>
</label></li>
<li><label><input type="checkbox">Confirm hierarchy: stations &gt; subway lines &gt; basemap</label></li>
</ul>
</section>
</section>
<section id="step-6-build-print-layout" class="level3">
<h3 class="anchored" data-anchor-id="step-6-build-print-layout">ğŸ–¨ Step 6 â€” Build Print Layout</h3>
<p><strong>Goal:</strong> Create a complete, readable map composition.</p>
<section id="required-elements" class="level4">
<h4 class="anchored" data-anchor-id="required-elements">â˜‘ï¸ Required Elements</h4>
<ul class="task-list">
<li><label><input type="checkbox">Clear title<br>
</label></li>
<li><label><input type="checkbox">Legend for subway lines (division colors clearly labeled)<br>
</label></li>
<li><label><input type="checkbox">Size legend for ridership<br>
</label></li>
<li><label><input type="checkbox">Scale bar<br>
</label></li>
<li><label><input type="checkbox">North arrow<br>
</label></li>
<li><label><input type="checkbox">Data sources<br>
</label></li>
<li><label><input type="checkbox">Your name + date</label></li>
</ul>
</section>
<section id="legend-logic-requirement" class="level4">
<h4 class="anchored" data-anchor-id="legend-logic-requirement">âœ… Legend Logic Requirement</h4>
<p>Your map must clearly communicate:</p>
<ul>
<li><strong>Color = Division</strong><br>
</li>
<li><strong>Size = Average Weekday Ridership</strong></li>
</ul>
</section>
<section id="advanced-symbology-data-defined-size-legend" class="level4">
<h4 class="anchored" data-anchor-id="advanced-symbology-data-defined-size-legend">ğŸ§© Advanced Symbology â€” Data-Defined Size Legend</h4>
<p>Because your proportional symbols are data-defined, you must explicitly construct a readable size legend.</p>
<p>Open:</p>
<p><em>Layer Properties â†’ Symbology</em></p>
</section>
<section id="confirm-data-defined-size" class="level4">
<h4 class="anchored" data-anchor-id="confirm-data-defined-size">ğŸ“ 1ï¸âƒ£ Confirm Data-Defined Size</h4>
<ul>
<li>Ensure the marker size is controlled by a data-defined expression via <em>Advanced &gt; Data-defined Size Legend</em></li>
</ul>
</section>
<section id="configure-legend-entries" class="level4">
<h4 class="anchored" data-anchor-id="configure-legend-entries">ğŸ§­ 2ï¸âƒ£ Configure Legend Entries</h4>
<p>Under <em>Advanced â†’ Data-defined Size Legend</em></p>
<ul>
<li>Enable: <em>â€œLegend for data-defined sizeâ€</em></li>
<li>Choose: <em>Collapsed legend</em></li>
<li>Use <em>Manual size classes</em> for maximum control</li>
</ul>
<p>Example legend values:</p>
<ul>
<li>Small Stations | 80,000 or less</li>
<li>Medium-Small Stations | 180,000</li>
<li>Medium stations | 300,000</li>
<li>Large Stations | 800,000</li>
<li>Largest Stations | 4,000,000</li>
</ul>
</section>
</section>
<section id="step-7-export-deliverables" class="level3">
<h3 class="anchored" data-anchor-id="step-7-export-deliverables">ğŸ“¤ Step 7 â€” Export Deliverables</h3>
<section id="checklist-4" class="level4">
<h4 class="anchored" data-anchor-id="checklist-4">â˜‘ï¸ Checklist</h4>
<ul class="task-list">
<li><label><input type="checkbox">Export as PDF or PNG<br>
</label></li>
<li><label><input type="checkbox">Resolution: 300 dpi minimum<br>
</label></li>
<li><label><input type="checkbox">Save QGIS project for backup/archive purposes (.qgs)</label></li>
</ul>
</section>
<section id="file-naming" class="level4">
<h4 class="anchored" data-anchor-id="file-naming">ğŸ“ File Naming</h4>
<pre><code>LastName_Assignment4_SubwayMap.pdf</code></pre>
</section>
</section>
<section id="reflection-150250-words" class="level3">
<h3 class="anchored" data-anchor-id="reflection-150250-words">âœï¸ Reflection (150â€“250 Words)</h3>
<p>Address:</p>
<ul>
<li>Where does ridership density occur?<br>
</li>
<li>Does Manhattan visually dominate? Why?<br>
</li>
<li>How well can a viewer interpret both variables simultaneously?<br>
</li>
<li>What design approach have you used to improve clarity?</li>
</ul>
</section>
<section id="deliverables-at-canvas" class="level3">
<h3 class="anchored" data-anchor-id="deliverables-at-canvas">ğŸ“¦ Deliverables at Canvas</h3>
<ul>
<li>Final Map Export (.pdf or .png)<br>
</li>
<li>Reflection Submission (.txt)</li>
</ul>
</section>
<section id="map-example" class="level3">
<h3 class="anchored" data-anchor-id="map-example">ğŸ“Œ Map Example</h3>
<ul>
<li><a href="https://mapexamples.s3.us-east-2.amazonaws.com/c4_stgis_map-example.pdf">Link to full-sized PDF Map Example</a></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="c4_assignment_files/img/c4-map-example.png" class="img-fluid figure-img"></p>
<figcaption>Deliverable Map Example</figcaption>
</figure>
</div>
</section>
<section id="grading-rubric" class="level3">
<h3 class="anchored" data-anchor-id="grading-rubric">ğŸ§® Grading Rubric</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Criteria</th>
<th>Description</th>
<th style="text-align: right;">Weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data Preparation &amp; Join Accuracy</td>
<td>Correct loading, join key identified, ridership field valid</td>
<td style="text-align: right;"><strong>20%</strong></td>
</tr>
<tr class="even">
<td>Categorical Symbolization</td>
<td>Clear, meaningful division-based color system</td>
<td style="text-align: right;"><strong>20%</strong></td>
</tr>
<tr class="odd">
<td>Proportional Symbol Scaling</td>
<td>Appropriate size range, minimal distortion, readable pattern</td>
<td style="text-align: right;"><strong>25%</strong></td>
</tr>
<tr class="even">
<td>Map Layout &amp; Design</td>
<td>Professional layout, clear two-variable legend logic, hierarchy</td>
<td style="text-align: right;"><strong>25%</strong></td>
</tr>
<tr class="odd">
<td>Reflection &amp; Critical Insight</td>
<td>Demonstrates conceptual understanding of multivariate mapping</td>
<td style="text-align: right;"><strong>10%</strong></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td></td>
<td style="text-align: right;"><strong>100%</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="conceptual-takeaway" class="level3">
<h3 class="anchored" data-anchor-id="conceptual-takeaway">ğŸ§  Conceptual Takeaway</h3>
<p>This assignment demonstrates multivariate cartography:</p>
<ul>
<li><strong>Color communicates difference in kind</strong></li>
<li><strong>Size communicates difference in magnitude</strong></li>
<li>Effective maps require careful management of hierarchy, clutter, and legend clarity.</li>
</ul>
</section>
<section id="video-guides" class="level3">
<h3 class="anchored" data-anchor-id="video-guides">Video Guides</h3>
<ul>
<li><strong>Video 1 - Understanding Map Scale</strong>:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://youtu.be/PmTCxRWEwms"><img src="https://i.imgur.com/o0XVKUf.png" class="img-fluid figure-img"></a></p>
<figcaption>map scale video</figcaption>
</figure>
</div>
<ul>
<li><strong>Video 2 - QGIS Scale Bar Development</strong>:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://vimeo.com/458314909"><img src="https://i.imgur.com/1zAx23C.png" class="img-fluid figure-img"></a></p>
<figcaption>Scale Bar Development</figcaption>
</figure>
</div>
</section>
<section id="further-reference" class="level3">
<h3 class="anchored" data-anchor-id="further-reference">Further Reference</h3>
<ul>
<li><p><a href="https://blog.datawrapper.de/beautifulcolors/?utm_campaign=carto%205&amp;utm_medium=email&amp;_hsmi=95199854&amp;_hsenc=p2ANqtz--rdgSgmxX7LqDujHGO-NA5MLqwCnpH4md30WShr_qXJWFtlwDkmaTVDecTxIofGj8QDCgNUqIrLoplI3ohDmODe1BO-A&amp;utm_content=95178448&amp;utm_source=hs_email">How to pick beautiful colors</a></p></li>
<li><p><a href="http://www.rgbtohex.net/hextorgb/">Hex Converter</a></p></li>
<li><p><a href="http://grindgis.com/blog/difference-between-cartography-and-gis">The Difference between cartography and GIS</a></p></li>
<li><p><a href="https://gisgeography.com/map-elements-how-to-guide-map-making">33 Map Elements to Include in Cartographic Design: A â€˜How toâ€™ Guide to Map Making - GIS Geography</a></p></li>
<li><p><a href="https://www.ordnancesurvey.co.uk/blog/a-z-of-cartography/">Ordnance Survey â€˜A to Zâ€™ of Cartography</a></p></li>
<li><p><a href="https://github.com/palewire/usa-style-guides/raw/master/usgs/Page-Size_Illustration_Standards.pdf">USGS Style Guide PDF</a></p></li>
<li><p><a href="https://github.com/palewire/usa-style-guides/tree/master/usgs">USGS Style Guide PDF sheets + Illustrator sheets</a></p></li>
<li><p><a href="http://groundwater.fullerton.edu/Maps,_Scale,_GIS_and_GPS/Guide_to_Map_Scale.html">Guide to Map Scales</a></p></li>
<li><p><a href="https://pubs.usgs.gov/fs/2002/0015/report.pdf">USGS Guide to Map Scales</a></p></li>
<li><p><a href="https://www.esri.com/arcgis-blog/products/product/mapping/globe-locator-map/">Advanced Map inset/locator - A Global Locator Map</a></p></li>
<li><p><a href="http://www.statsmapsnpix.com/2019/09/globe-projections-and-insets-in-qgis.html?utm_campaign=Spatial%20Awareness&amp;utm_medium=email&amp;utm_source=Revue%20newsletter">QGIS version of A Global Locator Map</a></p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="c4_assignment_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>